{% block contents %}
	<form action="{{ url_for('short') }}" method="post">
		<div id="shortForm">
			<input type="text" name="url" placeholder="Enter the link here">
			<div id="submitBtn">
				<input type="submit" value="Cut!">
			</div>
		</div>
		<p>
		<details>
			<summary>Advanced Options:</summary>
			<div class="left-column">
				<label for="captcha">Enable Captcha Security? </label>
				<input type="checkbox" id="captcha" name="captcha">
				<br>
				<label for="customSlug">Custom Slug? </label>
				<input type="checkbox" id="customSlug" name="customSlug" onchange="toggleCustomSlug()">
				<input type="text" id="slugInput" name="slugInput" value="XXXXXX" readonly minlength="6" maxlength="6"
					   required oninput="enforceSlugInputRestrictions()">
			</div>
			<div class="right-column">
				<label for="public">Public? </label>
				<input type="checkbox" id="public" checked name="public">
				<br>
				<label for="expiryClicks">Expire after (clicks): </label>
				<select name="expiryClicks" id="expiryClicks">
				</select>
			</div><br>
		</details>
		</p>
	</form>
	<script>
		let expiryClicksSelectBox = document.getElementById("expiryClicks");
		expires = [1, 2, 5, 10, 25, 50, 100, 250, 500, 1000, 2000, 5000];
		for (let i = 0; i <= 10; i++) {
			let option = document.createElement("option");
			option.text = expires[i];
			option.value = expires[i];
			expiryClicksSelectBox.add(option);
		}
		let option = document.createElement("option");
		option.text = "Never";
		option.value = "0";
		expiryClicksSelectBox.add(option);

		function toggleCustomSlug() {
			let checkbox = document.getElementById('customSlug');
			let input = document.getElementById('slugInput');
			if (checkbox.checked) {
				input.readOnly = false;
			} else {
				input.value = 'XXXXXX';
				input.readOnly = true;
			}
		}

		function enforceSlugInputRestrictions() {
			let input = document.getElementById('slugInput');
			input.value = input.value.toUpperCase();
			input.value = input.value.replace(/ /g, '-');
			input.value = input.value.replace(/[^A-Z0-9-_]/g, '');
		}
	</script>
{% endblock %}
